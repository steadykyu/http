# 1. URI

## 1.1 정의

Uniform Resource Identifier

<h2 align="center">
"URI는 <br>로케이터(locator), 이름(name) 또는 둘다 추가로 분류될 수 있다"
</h2>

표준 출처 : https://www.ietf.org/rfc/rfc3986.txt

> 구조1

<p align="center">
<img src ="https://github.com/steadykyu/http/blob/master/img/http2_1.png" width="70%" height="70%">
</p>

> 구조2

<p align="center">
<img src ="https://github.com/steadykyu/http/blob/master/img/http2_2.png" width="70%" height="70%">
</p>

## 1.2 URI 단어뜻

- Uniform: 리소스 식별하는 통일된 방식

- Resource: 자원, URI로 식별할 수 있는 모든 것(제한 없음)

```
자원 : html 뿐만 아니라 구분할수 있는 모든 정보들을 의미
```

- Identifier: 다른 항목과 구분하는데 필요한 정보

## 1.3 URL, URN 단어 뜻

- URL - Locator: 리소스가 있는 위치를 지정

- URN - Name: 리소스에 이름을 부여

- 위치는 변할 수 있지만, 이름은 변하지 않는다.(불변의 특징이 좋지는 않음.)

- 예시 : urn:isbn:8960777331 (어떤 책의 isbn URN)

- URN 이름만으로 실제 리소스를 찾을 수 있는 방법이 보편화 되지 않음

- 앞으로 URI를 URL과 같은 의미로 이야기하겠음

## 1.4 URL 분석

```
https://www.google.com/search?q=hello&hl=ko
```

## 1.4.1 URL 전체 문법

- scheme://[userinfo@]host[:port][/path][?query][#fragment]

- https://www.google.com:443/search?q=hello&hl=ko

```
• 프로토콜(https)
• 호스트명(www.google.com)
• 포트 번호(443)
• path(/search)
• 쿼리 파라미터(q=hello&hl=ko)
```

### 1.4.1 URL scheme

- scheme://[userinfo@]host[:port][/path][?query][#fragment]

- https://www.google.com:443/search?q=hello&hl=ko

- 주로 프로토콜 입력에 사용

- 프로토콜: 어떤 방식으로 자원에 접근할 것인가 하는 약속 규칙

- 예) http, https, ftp 등등

- http는 80 포트, https는 443 포트를 주로 사용, **포트는 생략 가능**

- https는 http에 보안 추가 (HTTP Secure)

> 참고

https 는 http의 강력한 보안이 들어간 것이다. 요즘 대부분은 https를 사용한다.

### 1.4.2 userinfo

- scheme://[userinfo@]host[:port][/path][?query][#fragment]

- https://www.google.com:443/search?q=hello&hl=ko

- URL에 사용자정보를 포함해서 인증

- 거의 사용하지 않음

### 1.4.3 URL host

- scheme://[userinfo@]host[:port][/path][?query][#fragment]
- https://www.google.com:443/search?q=hello&hl=ko

- 호스트명
- 도메인명 또는 IP 주소를 직접 사용가능

### 1.4.4 URL PORT

- scheme://[userinfo@]host[:port][/path][?query][#fragment]
- https://www.google.com:443/search?q=hello&hl=ko
- 포트(PORT)
- 접속 포트
- **일반적으로 생략**, 생략시 http는 80, https는 443

### 1.4.5 URL path

- scheme://[userinfo@]host[:port][/path][?query][#fragment]

- https://www.google.com:443/search?q=hello&hl=ko

- 리소스 경로(path), 계층적 구조
- 예) 설계 하기 나름이다.
  - /home/file1.jpg (디렉터리 형구조)
  - /members
  - /members/100, /items/iphone12 (컬렉션 같은 구조)

### 1.4.6 URL query

- scheme://[userinfo@]host[:port][/path][?query][#fragment]

- https://www.google.com:443/search?q=hello&hl=ko

- key=value 형태

- ?로 시작, &로 추가 가능 ?keyA=valueA&keyB=valueB

- query parameter, query string 등으로 불림, 웹서버에 제공하는 파라미터, 문자 형태

### 1.4.7 URL fragment

- scheme://[userinfo@]host[:port][/path][?query][#fragment]
- https://docs.spring.io/spring-boot/docs/current/reference/html/getting-started.html#getting-started-introducing-spring-boot

- fragment
- html 내부 북마크 등에 사용(html 창의 중간이나 끝부분으로 가는 마크)
- 서버에 전송하는 정보 아님

# 2. 웹 브라우저 요청 흐름

> http 요청 메시지 생성

<p align="center">
<img src ="https://github.com/steadykyu/http/blob/master/img/http2_3.png" width="70%" height="70%">
</p>

DNS 조회를 통해 얻은 목적지 IP와 목적지 port를 통해 http 메시지를 생성

모양은 다음과 같다.

> http 요청메시지

<p align="center">
<img src ="https://github.com/steadykyu/http/blob/master/img/http2_4.png" width="70%" height="70%">
</p>

> Http 메시지 전송

<p align="center">
<img src ="https://github.com/steadykyu/http/blob/master/img/http2_5.png" width="70%" height="70%">
</p>

- SOCKET 라이브러리 에서 TCP/IP 정보를 가지고 TCP 3 way handshake를 한다.(syn, ack 작업)

<p align="center">
<img src ="https://github.com/steadykyu/http/blob/master/img/http2_6.png" width="70%" height="70%">
</p>

<p align="center">
<img src ="https://github.com/steadykyu/http/blob/master/img/http2_7.png" width="70%" height="70%">
</p>

- 클라 -> 서버 여러 서버 노드를 거쳐서 지나간다.

- TCP/IP를 뜯어서 버리고, 클라이언트가 보낸HTTP 메세지를 본인이 해석한다.

- 서버에서 해석후, 알맞은 데이터를 찾은후 응답패킷으로 만들어 http 응답메시지를 날린다.

<p align="center">
<img src ="https://github.com/steadykyu/http/blob/master/img/http2_8.png" width="70%" height="70%">
</p>

예시는 html로 구성되어 있다.

<p align="center">
<img src ="https://github.com/steadykyu/http/blob/master/img/http2_9.png" width="70%" height="70%">
</p>

클라이언트는 패킷 속 응답메시지에 들어있는 html을 렌더링 한다.
